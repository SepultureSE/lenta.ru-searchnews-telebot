![watermark](https://i.ibb.co/BTRHNCZ/d-Txp-Pi9l-Df.png)
# Telegram бот-парсер Lenta.ru

**Telegram бот** для получения статей с ресурса Lenta.ru посредством парсинга. Раньше в этом репозитории лежал тот же проект, но с довольно старым кодом. Проект не несет в себе какой-то пользы, он создан исключительно для того, чтобы показать мои навыки и анализировать свой прогресс.

### Что изменилось после старого кода?
##### Исключение Selenium Webdriver

Ранее я не был силен в запросах на web-ресурсы с помощью Python *(модуль Requests)*, поэтому, чтобы реализовать парсинг данных по поисковому запросу в Lenta.ru:

![Поиск](https://i.ibb.co/nwM1H8h/Screenshot-3.png "Поисковая строка на сайте Lenta.ru")

Я использовал *selenium webdriver*, и по сути это **является** решением моей задачи, но для *selenium`а* нужен безголовый браузер, чтобы все работало, а это достаточно топорно в сравнении с тем, что я сделал в новом коде, а именно - использовал GET запрос с определенными параметрами, чтобы получить указанное количество статей. К слову, с помощью этого запроса можно действительно получить неограниченное количество постов, настроить сортировку и много чего еще. Так выглядит запрос у меня в коде:

```python
r = requests.get('https://lenta.ru/search/v2/process', headers=fake_agent, params={
            'from': '0',
            'size': str(config.search_responses_limit),
            'sort': '2',
            'title_only': '1',
            'domain': '1',
            'query': request
        })
```

Если выставить значение "size" на 100, то мы получим этот ответ от ресурса:

![](https://i.ibb.co/vBJDy0n/image.png)

Как я и говорил - мы получили 100  статей.

##### Использование ООП и .ini файлов
В старой версии проекта я почти не использовал ООП, но теперь в новом коде содержится 2 основных класса и одна функция: классы `Config`, `Parser` и функция `main`. 

Класс **Config** нужен для создания и получения данных из конфигурационного файла, где содержатся все необходимые настройки бота. Это очень удобно и подобный подход к работе я использую в каждом проекте. Так выглядит *config.ini*:

![](https://i.ibb.co/tCNF1z9/image.png)

Класс **Parser**, логично, отвечает за парсинг ресурса. В нем содержится два метода: `get_main_news(max_news: int)` и `get_news_by_request(request: str, max_news: int)`
Названия методов говорят сами за себя. Первый предназначен для парсинга главных новостей, а второй для получения данных с ресурса по поисковому запросу. 

Аргументы метода `get_main_news` - это **max_news**, предельное количество статей, которое должно быть получено.

Аргументы метода `get_news_by_request` - это **request**, сам поисковый запрос и **max_news** аналогичен аргументу метода `get_main_news`.

И наконец, в функции **main** содержится код Telegram бота. Изначально я хотел выделить и для него отдельный класс, но посчитал это ненужным. Эта функция вызывается в конструкции `if __name__ == '__main__`.
